{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}
{% block title %} Model {% endblock %}
{% block content %}

  <header id="gtco-header" class="gtco-cover gtco-cover-sm" role="banner" style="background-image: url({% static 'website/images/img_bg_1.jpg' %})">
    <div class="overlay"></div>
    <div class="gtco-container">
      <div class="row">
        <div class="col-md-12 col-md-offset-0 text-left">
          <div class="row row-mt-15em">
            <div class="col-md-7 mt-text animate-box" data-animate-effect="fadeInUp">
              <span class="intro-text-small">Let the algorithm do the hard stuff!</span>
              <h1>The Model</h1> 
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

<div class="gtco-section">
    <div class="gtco-container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2 text-center gtco-heading">
          <h2>Let's get down to the nitty-gritty!</h2>
          <p>Introduce the data of your car and click on the calculate button</p>
        </div>
      </div>
      <div class="row">

        

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


<form class="" action="prediction" method="post">
          {% csrf_token %}
          {% for error in errors  %}
          <div class="alert alert-danger mb-4" role="alert">
            <strong>{{ error }}</strong>
          </div>
          {% endfor %}
          <div class="form-row">
            <div class="form-group col-md-6">
              <label>Make:</label>
                {{ form.make }}
            </div>
            <div class="form-group col-md-6">
              <label>Model:</label>
              <select id="id_model" class="form-control" name="model">
                <option value="-----">Select Model</option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Body type:</label>
              <select id="id_body_type" class="form-control" name="body_type">
                <option value="-----">Select Body Type</option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Fuel type:</label>
              <select id="id_fuel_type" class="form-control" name="fuel_type">
                <option value="-----">Select Fuel Type</option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Transmission:</label>
              <select id="id_transmission" class="form-control" name="transmission">
                <option value="-----">Select Transmission</option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Horsepower:</label>
              <select id="id_horsepower" class="form-control" name="Horsepower">
                <option value="-----">Select Horsepower</option>
              </select>
            </div>
            <div class="form-group col-md-6">
              <label>Engine displacement (cc):</label>
              {{ form.engine_displacement }}
            </div>
            <div class="form-group col-md-6">
              <label>Engine:</label>
              {{ form.engine_type }}
            </div>
            <div class="form-group col-md-6">
              <label>Wheel system:</label>
              {{ form.wheel_system }}
            </div>
            <div class="form-group col-md-6">
              <label>Gears:</label>
              {{ form.transmission_display }}
            </div>
            <div class="form-group col-md-6">
              <label>Year:</label>
              {{ form.year }}
            </div>
            <div class="form-group col-md-6">
              <label>Fuel tank volume (gal):</label>
              {{ form.fuel_tank_volume }}
            </div>
            <div class="form-group col-md-6">
              <label>City fuel economy (km/l):</label>
              {{ form.city_fuel_economy }}
            </div>
            <div class="form-group col-md-6">
              <label>Highway fuel economy (km/l):</label>
              {{ form.highway_fuel_economy }}
            </div>
            <div class="form-group col-md-6">
              <label>Color:</label>
              {{ form.exterior_color }}
            </div>
            <div class="form-group col-md-6">
              <label>Seats:</label>
              {{ form.maximum_seating }}
            </div>
            <div class="form-group col-md-6">
              <label>Status:</label>
              {{ form.is_new }}
            </div>
            <div class="form-group col-md-6">
              <label>Mileage (miles):</label>
              {{ form.mileage }}
            </div>
            <div class="form-group col-md-6">
              <button type="submit" class="btn btn-primary">Calculate</button>
            </div>
        </form>


<script type="text/javascript">
$(document).on('change', "#id_make", function () {
      var make = $(this).val();
      $.ajax({
        type: "POST",
        url: "{% url 'get-model' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
          'make': make,
        },
        success: function (data) {
          console.log(data.models);
          let html_data = '<option value="">Select Model</option>';
          data.models.forEach(function (data) {
              html_data += `<option value="${data}">${data}</option>`
          });
          $("#id_model").html(html_data);
        }
      });
  });
</script> 

<script type="text/javascript">
$(document).on('change', "#id_model", function () {
      var model = $(this).val();
      var make = $("#id_make").val();
      $.ajax({
        type: "POST",
        url: "{% url 'getBodyType' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
          'model': model,
          'make': make,
        },
        success: function (data) {
          console.log(data.body_types);
          let html_data = '<option value="">Select Body Type</option>';
          data.body_types.forEach(function (data) {
              html_data += `<option value="${data}">${data}</option>`
          });
          $("#id_body_type").html(html_data);
        }
      });
  });
</script>

<script type="text/javascript">
$(document).on('change', "#id_body_type", function () {
      var body = $(this).val();
      var model = $("#id_model").val();
      var make = $("#id_make").val();
      $.ajax({
        type: "POST",
        url: "{% url 'getFuelType' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
          'body': body,
          'model': model,
          'make': make,
        },
        success: function (data) {
          console.log(data.fuel_types);
          let html_data = '<option value="">Select Fuel Type</option>';
          data.fuel_types.forEach(function (data) {
              html_data += `<option value="${data}">${data}</option>`
          });
          $("#id_fuel_type").html(html_data);
        }
      });
  });
</script>

<script type="text/javascript">
$(document).on('change', "#id_fuel_type", function () {
      var fuel = $(this).val();
      var body = $("#id_body_type").val();
      var model = $("#id_model").val();
      var make = $("#id_make").val();
      $.ajax({
        type: "POST",
        url: "{% url 'getTransmission' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
          'fuel': fuel,
          'body': body,
          'model': model,
          'make': make,
        },
        success: function (data) {
          console.log(data.transmissions);
          let html_data = '<option value="">Select Transmission</option>';
          data.transmissions.forEach(function (data) {
              html_data += `<option value="${data}">${data}</option>`
          });
          $("#id_transmission").html(html_data);
        }
      });
  });
</script>
    

<script type="text/javascript">
$(document).on('change', "#id_transmission", function () {
      var transmission = $(this).val();
      var fuel = $("#id_fuel_type").val();
      var body = $("#id_body_type").val();
      var model = $("#id_model").val();
      var make = $("#id_make").val();
      $.ajax({
        type: "POST",
        url: "{% url 'getHorsepower' %}",
        data: {
          'csrfmiddlewaretoken': '{{ csrf_token }}',
          'transmission': transmission,
          'fuel': fuel,
          'body': body,
          'model': model,
          'make': make,
        },
        success: function (data) {
          console.log(data.horsepowers);
          let html_data = '<option value="">Select Horsepower</option>';
          data.horsepowers.forEach(function (data) {
              html_data += `<option value="${data}">${data}</option>`
          });
          $("#id_horsepower").html(html_data);
        }
      });
  });
</script>




      </div>
    </div>
  </div>








{% endblock %} 